
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Good function design choices &#8212; Programming in Python for Data Science</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.e8e5499552300ddf5d7adccae7cc3b70.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/video.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://hfboyce.github.io/ppds/intro.html/modules/module6/module6_22.html" />
    <link rel="shortcut icon" href="../../_static/icon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      <img src="../../_static/logo.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Programming in Python for Data Science</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <p class="caption">
 <span class="caption-text">
  Modules
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../module1.html">
   Module 1:  Python &amp; Pandas - An Unexpected Friendship
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../module1/module1_01.html">
     What is a dataframe?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module1/module1_03.html">
     What is Pandas?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module1/module1_07.html">
     Slicing Rows using .loc[]
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module1/module1_11.html">
     Slicing only columns using .loc[]
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module1/module1_13.html">
     Selecting using .loc[]
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module1/module1_16.html">
     Obtaining dataframe values
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module1/module1_18.html">
     Selecting a Single Column
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module1/module1_20.html">
     Slicing and selecting using .iloc[]
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module1/module1_24.html">
     Sorting dataframes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module1/module1_26.html">
     Summary Statistics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module1/module1_29.html">
     Frequency Tables and Writing CSVs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../module1/module1_31.html">
     Quick viz with Altair!
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/modules/module6/module6_22.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/UBC-MDS/PPDS_book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/UBC-MDS/PPDS_book/issues/new?title=Issue%20on%20page%20%2Fmodules/module6/module6_22.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/UBC-MDS/PPDS_book/edit/main/modules/module6/module6_22.md"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Good function design choices
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-write-good-functions">
     How to write good functions
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#avoid-hard-coding">
     1. Avoid “hard coding.”
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#less-is-more">
     2. Less is More
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#return-a-single-object">
     3. Return a single object
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#keep-global-variables-in-their-global-environment">
     4. Keep global variables in their global environment
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lets-apply-what-we-learned">
   Let’s apply what we learned!
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="good-function-design-choices">
<h1>Good function design choices<a class="headerlink" href="#good-function-design-choices" title="Permalink to this headline">¶</a></h1>
<p>Notes:</p>
<br>
<hr class="docutils" />
<div class="section" id="how-to-write-good-functions">
<h2>How to write good functions<a class="headerlink" href="#how-to-write-good-functions" title="Permalink to this headline">¶</a></h2>
<p><strong>What makes a function useful?</strong></p>
<p><strong>Is a function more useful when it does more operations?</strong></p>
<p><strong>Do adding parameters make your functions more or less functional?</strong></p>
<p>These are all questions we need to think about when writing functions.</p>
<p>Notes:</p>
<p>This has been quite a full module!</p>
<p>We’ve learned how to make functions, how to handle errors gracefully,
how to test our functions, and write the necessary documentation to keep
our code comprehensible.</p>
<p>These skills will all contribute to writing effective code.</p>
<p>One thing we have not discussed yet is the actual code within a
function.</p>
<p><strong>What makes a function useful?</strong></p>
<p><strong>Is a function more useful when it performs more operations?</strong></p>
<p><strong>Does adding parameters make your functions more or less useful?</strong></p>
<p>These are all questions we need to think about when writing functions.</p>
<p>We are going to list some habits to adopt when writing and designing
your functions.</p>
</div>
<hr class="docutils" />
<div class="section" id="avoid-hard-coding">
<h2>1. Avoid “hard coding.”<a class="headerlink" href="#avoid-hard-coding" title="Permalink to this headline">¶</a></h2>
<p><strong>Hard coding</strong> is the process of embedding values directly into your
code without saving them in objects.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">squares_a_list</span><span class="p">(</span><span class="n">numerical_list</span><span class="p">):</span>
    <span class="n">new_squared_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    
    <span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="n">numerical_list</span><span class="p">:</span>
        <span class="n">new_squared_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">number</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">new_squared_list</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">exponent_a_list</span><span class="p">(</span><span class="n">numerical_list</span><span class="p">,</span> <span class="n">exponent</span><span class="p">):</span>
    <span class="n">new_exponent_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    
    <span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="n">numerical_list</span><span class="p">:</span>
        <span class="n">new_exponent_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">number</span> <span class="o">**</span> <span class="n">exponent</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">new_exponent_list</span>
</pre></div>
</div>
<p>Notes:</p>
<p><strong>Hard coding</strong> is the process of embedding values directly into your
code without saving them in variables</p>
<p>When we hardcode values into our code, it decreases flexibility.</p>
<p>Being inflexible can cause you to end up writing more functions and/or
violating the DRY principle.</p>
<p>This, in turn, can decrease the readability and makes code problematic
to maintain. In short, hard coding is a breeding ground for bugs.</p>
<p>Remember our function <code class="docutils literal notranslate"><span class="pre">squares_a_list()</span></code>?</p>
<p>In this function, we “hard-coded” in <code class="docutils literal notranslate"><span class="pre">2</span></code> when we calculated <code class="docutils literal notranslate"><span class="pre">number</span> <span class="pre">**</span> <span class="pre">2</span></code>.</p>
<p>There are a couple of approaches to improving the situation. One is to
assign 2 to a variable in the function before doing this calculation.
That way, if you need to reuse that number, later on, you can just refer
to the variable; and if you need to change the 2 to a 3, you only need
to change it in one place. Another benefit is that you’re giving it a
variable name, which acts as a little bit of documentation.</p>
<p>The other approach is to turn the value into an argument like we did
when we made <code class="docutils literal notranslate"><span class="pre">exponent_a_list()</span></code>.</p>
<p>This new function now gives us more flexibility with our code.</p>
<p>If we now encounter a situation where we need to calculate each element
to a different exponent like 4 or 0, we can do so without writing new
code and potentially making a new error in doing so.</p>
<p>We reduce our long term workload.</p>
<p>This version is more maintainable code, but it doesn’t give the function
caller any flexibility. What you decide depends on how you expect your
function to be used.</p>
</div>
<hr class="docutils" />
<div class="section" id="less-is-more">
<h2>2. Less is More<a class="headerlink" href="#less-is-more" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">load_filter_and_average</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">grouping_column</span><span class="p">,</span> <span class="n">ploting_column</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="n">source</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">grouping_column</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">chart</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">300</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
                      <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="n">grouping_column</span><span class="p">),</span>
                      <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="n">ploting_column</span><span class="p">)</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">chart</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bad_idea</span> <span class="o">=</span> <span class="n">load_filter_and_average</span><span class="p">(</span><span class="s1">&#39;cereal.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;mfr&#39;</span><span class="p">,</span> <span class="s1">&#39;rating&#39;</span><span class="p">)</span>
<span class="n">bad_idea</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="module6/chart_bad_idea.png"><img alt="module6/chart_bad_idea.png" src="module6/chart_bad_idea.png" style="width: 40%;" /></a>
<p>Notes:</p>
<p>Although it may seem useful when a function acts as a one-stop-shop that
does everything you want in a single function, this also limits your
ability to reuse code that lies within it.</p>
<p>Ideally, functions should serve a single purpose.</p>
<p>For example, let’s say we have a function that reads in a csv, finds the
mean of each group in a column, and plots a specified variable.</p>
<p>Although this may seem nice, we may want to break this up into multiple
smaller functions. For example, what if we don’t want the plot? Perhaps
the plot is just something we wanted a single time, and now we are
committed to it for each time we use the function.</p>
<p>Another problem with this function is that the means are only printed
and not returned. Thus, we have no way of accessing the statistics to
use further in our code (we would have to repeat ourselves and rewrite
it).</p>
<hr class="docutils" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">grouped_means</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">grouping_column</span><span class="p">):</span>
    <span class="n">grouped_mean</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">grouping_column</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">grouped_mean</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cereal_mfr</span> <span class="o">=</span> <span class="n">grouped_means</span><span class="p">(</span><span class="n">cereal</span><span class="p">,</span> <span class="s1">&#39;mfr&#39;</span><span class="p">)</span>
<span class="n">cereal_mfr</span>
</pre></div>
</div>
<div class="highlight-out notranslate"><div class="highlight"><pre><span></span>  mfr    calories   protein       fat      sodium     fiber      carbo    sugars      potass   vitamins     shelf    weight      cups     rating
0   A  100.000000  4.000000  1.000000    0.000000  0.000000  16.000000  3.000000   95.000000  25.000000  2.000000  1.000000  1.000000  54.850917
1   G  111.363636  2.318182  1.363636  200.454545  1.272727  14.727273  7.954545   85.227273  35.227273  2.136364  1.049091  0.875000  34.485852
2   K  108.695652  2.652174  0.608696  174.782609  2.739130  15.130435  7.565217  103.043478  34.782609  2.347826  1.077826  0.796087  44.038462
3   N   86.666667  2.833333  0.166667   37.500000  4.000000  16.000000  1.833333  121.000000   8.333333  1.666667  0.971667  0.778333  67.968567
4   P  108.888889  2.444444  0.888889  146.111111  2.777778  13.222222  8.777778  113.888889  25.000000  2.444444  1.064444  0.714444  41.705744
5   Q   95.000000  2.625000  1.750000   92.500000  1.337500  10.250000  5.500000   74.375000  12.500000  2.375000  0.875000  0.823750  42.915990
6   R  115.000000  2.500000  1.250000  198.125000  1.875000  17.625000  6.125000   89.500000  25.000000  2.000000  1.000000  0.871250  41.542997
</pre></div>
</div>
<p>Notes:</p>
<p>In this case, you want to simplify the function.</p>
<p>Having a function that only calculates the mean values of the groups in
the specified column is much more usable.</p>
<p>A preferred function would look something like this, where the input is
a dataframe we have already read in, and the output is the dataframe of
mean values for all the columns.</p>
<hr class="docutils" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_mean</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">grouping_column</span><span class="p">,</span> <span class="n">ploting_column</span><span class="p">):</span>
    <span class="n">chart</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">300</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
                      <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="n">grouping_column</span><span class="p">),</span>
                      <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="n">ploting_column</span><span class="p">)</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">chart</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plot1</span> <span class="o">=</span> <span class="n">plot_mean</span><span class="p">(</span><span class="n">cereal_mfr</span><span class="p">,</span> <span class="s1">&#39;mfr&#39;</span><span class="p">,</span> <span class="s1">&#39;rating&#39;</span><span class="p">)</span>
<span class="n">plot1</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="module6/plot_better.png"><img alt="module6/plot_better.png" src="module6/plot_better.png" style="width: 50%;" /></a>
<p>Notes:</p>
<p>If we wanted, we could then make a second function that creates the
desired plot part of the previous function.</p>
</div>
<hr class="docutils" />
<div class="section" id="return-a-single-object">
<h2>3. Return a single object<a class="headerlink" href="#return-a-single-object" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">load_filter_and_average</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">grouping_column</span><span class="p">,</span> <span class="n">ploting_column</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="n">source</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">grouping_column</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">chart</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">300</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
                      <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="n">grouping_column</span><span class="p">),</span>
                      <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="n">ploting_column</span><span class="p">)</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">chart</span><span class="p">,</span> <span class="n">source</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">another_bad_idea</span> <span class="o">=</span> <span class="n">load_filter_and_average</span><span class="p">(</span><span class="s1">&#39;cereal.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;mfr&#39;</span><span class="p">,</span> <span class="s1">&#39;rating&#39;</span><span class="p">)</span>
<span class="n">another_bad_idea</span>
</pre></div>
</div>
<div class="highlight-out notranslate"><div class="highlight"><pre><span></span>(alt.Chart(...),   mfr    calories   protein       fat      sodium     fiber      carbo    sugars      potass   vitamins     shelf    weight      cups     rating
0   A  100.000000  4.000000  1.000000    0.000000  0.000000  16.000000  3.000000   95.000000  25.000000  2.000000  1.000000  1.000000  54.850917
1   G  111.363636  2.318182  1.363636  200.454545  1.272727  14.727273  7.954545   85.227273  35.227273  2.136364  1.049091  0.875000  34.485852
2   K  108.695652  2.652174  0.608696  174.782609  2.739130  15.130435  7.565217  103.043478  34.782609  2.347826  1.077826  0.796087  44.038462
3   N   86.666667  2.833333  0.166667   37.500000  4.000000  16.000000  1.833333  121.000000   8.333333  1.666667  0.971667  0.778333  67.968567
4   P  108.888889  2.444444  0.888889  146.111111  2.777778  13.222222  8.777778  113.888889  25.000000  2.444444  1.064444  0.714444  41.705744
5   Q   95.000000  2.625000  1.750000   92.500000  1.337500  10.250000  5.500000   74.375000  12.500000  2.375000  0.875000  0.823750  42.915990
6   R  115.000000  2.500000  1.250000  198.125000  1.875000  17.625000  6.125000   89.500000  25.000000  2.000000  1.000000  0.871250  41.542997)
</pre></div>
</div>
<p>Notes:</p>
<p>For the most part, we have only lightly touched on the fact that
functions can return multiple objects, and it’s with good reason.</p>
<p>Although functions are <em>capable</em> of returning multiple objects, that
doesn’t mean that it’s the best option.</p>
<p>For instance, what if we converted our function
<code class="docutils literal notranslate"><span class="pre">load_filter_and_average()</span></code> so that it returns a dataframe <em><strong>and</strong></em> a
plot.</p>
<hr class="docutils" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">another_bad_idea</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="module6/plot_better.png"><img alt="module6/plot_better.png" src="module6/plot_better.png" style="width: 55%;" /></a>
<p>Notes:</p>
<p>Since our function returns a tuple, we can obtain the plot by selecting
the first element of the output.</p>
<p>This can be quite confusing. We would recommend separating the code into
two functions and can have each one return a single object.</p>
<p>It’s best to think of programming functions in the same way as
mathematical functions where most times, mathematical functions return a
single value.</p>
</div>
<hr class="docutils" />
<div class="section" id="keep-global-variables-in-their-global-environment">
<h2>4. Keep global variables in their global environment<a class="headerlink" href="#keep-global-variables-in-their-global-environment" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">grouped_means</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">grouping_column</span><span class="p">):</span>
    <span class="n">grouped_mean</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">grouping_column</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">grouped_mean</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cereal</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;cereal.csv&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">bad_grouped_means</span><span class="p">(</span><span class="n">grouping_column</span><span class="p">):</span>
    <span class="n">grouped_mean</span> <span class="o">=</span> <span class="n">cereal</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">grouping_column</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">grouped_mean</span>
</pre></div>
</div>
<p>Notes:</p>
<p>It’s generally bad form to include objects in a function that were
created outside of it.</p>
<p>Take our <code class="docutils literal notranslate"><span class="pre">grouped_means()</span></code> function.</p>
<p>What if instead of including <code class="docutils literal notranslate"><span class="pre">df</span></code> as an input argument, we just used
<code class="docutils literal notranslate"><span class="pre">cereal</span></code> that we loaded earlier?</p>
<p>The number one problem with doing this is now our function only works on
the cereal data - it’s not usable on other data.</p>
<hr class="docutils" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bad_cereal_grouping</span> <span class="o">=</span> <span class="n">bad_grouped_means</span><span class="p">(</span><span class="s1">&#39;mfr&#39;</span><span class="p">)</span>
<span class="n">bad_cereal_grouping</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-out notranslate"><div class="highlight"><pre><span></span>  mfr    calories   protein       fat      sodium     fiber      carbo    sugars      potass   vitamins     shelf    weight      cups     rating
0   A  100.000000  4.000000  1.000000    0.000000  0.000000  16.000000  3.000000   95.000000  25.000000  2.000000  1.000000  1.000000  54.850917
1   G  111.363636  2.318182  1.363636  200.454545  1.272727  14.727273  7.954545   85.227273  35.227273  2.136364  1.049091  0.875000  34.485852
2   K  108.695652  2.652174  0.608696  174.782609  2.739130  15.130435  7.565217  103.043478  34.782609  2.347826  1.077826  0.796087  44.038462
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cereal</span> <span class="o">=</span> <span class="s2">&quot;let&#39;s change it to a string&quot;</span> 
<span class="n">bad_cereal_grouping</span> <span class="o">=</span> <span class="n">bad_grouped_means</span><span class="p">(</span><span class="s1">&#39;mfr&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-out notranslate"><div class="highlight"><pre><span></span>AttributeError: &#39;str&#39; object has no attribute &#39;groupby&#39;

Detailed traceback: 
  File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;
  File &quot;&lt;string&gt;&quot;, line 2, in bad_grouped_means
</pre></div>
</div>
<p>Notes:</p>
<p>Ok, let’s say we still use it, then what happens?</p>
<p>Although it does work, global variables have the opportunity to be
altered in the global environment.</p>
<p>When we change the global variable outside the function and try to use
the function again, it will refer to the new global variable and
potentially no longer work.</p>
<p>Of course, like in any case, these habits are suggestions and not strict
rules.</p>
<p>There will be times where adhering to one of these may not be possible
or will hinder your code instead of enhancing it.</p>
<p>The rule of thumb is to ask yourself how helpful is your function if you
or someone else wishes to reuse it.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="lets-apply-what-we-learned">
<h1>Let’s apply what we learned!<a class="headerlink" href="#lets-apply-what-we-learned" title="Permalink to this headline">¶</a></h1>
<p>Notes:</p>
<br>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "UBC-MDS/PPDS_book",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./modules/module6"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Hayley Boyce, Mike Gelbart, Tiffany Timbers<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>